<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>–ü–æ–∑–Ω–∞–∫–æ–º–∏–º—Å—è - –ë–∞–±—É—à–∫–∏–Ω—ã –∏—Å—Ç–æ—Ä–∏–∏</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Caveat:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: 'Caveat', cursive;
      background: #0a0a1a url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%230a0a1a"/><path d="M0,50 Q25,20 50,50 T100,50" fill="none" stroke="%239c27b0" stroke-width="0.5" opacity="0.3"/><path d="M0,70 Q25,40 50,70 T100,70" fill="none" stroke="%239c27b0" stroke-width="0.5" opacity="0.3"/></svg>') repeat;
      color: #e0d4f7;
      text-align: center;
      min-height: 100vh;
      padding: 15px;
      position: relative;
      overflow: hidden;
      touch-action: manipulation;
    }

    body::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(30, 15, 0, 0.85);
      z-index: -1;
    }

    /* –≠—Ñ—Ñ–µ–∫—Ç –º–µ—Ä—Ü–∞—é—â–∏—Ö –∑–≤–µ–∑–¥ –≤ —Ñ–æ–Ω–µ */
    .stars {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
    }

    .star {
      position: absolute;
      background: white;
      border-radius: 50%;
      animation: twinkle 3s infinite;
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0.2; }
      50% { opacity: 1; }
    }

    .page {
      opacity: 0;
      transform: translateY(20px);
      animation: fadeIn 0.8s ease forwards;
    }

    @keyframes fadeIn {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .container {
      max-width: 100%;
      margin: 15px auto;
      padding: 20px 15px;
      background: rgba(40, 15, 70, 0.85);
      border: 1px solid #9c27b0;
      border-radius: 20px;
      box-shadow: 0 0 25px rgba(156, 39, 176, 0.5);
      position: relative;
      overflow: hidden;
    }

    .container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, transparent, #9c27b0, transparent);
    }

    .container::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, transparent, #9c27b0, transparent);
    }

    h1 {
      font-family: 'Playfair Display', serif;
      color: #e1bee7;
      font-size: 1.9em;
      text-shadow: 0 0 10px #9c27b0, 0 0 15px rgba(156, 39, 176, 0.6);
      margin-bottom: 15px;
      position: relative;
      letter-spacing: 1px;
    }

    h1::after {
      content: '';
      display: block;
      width: 80px;
      height: 3px;
      background: linear-gradient(90deg, transparent, #9c27b0, transparent);
      margin: 10px auto;
    }

    .subtitle {
      font-size: 1.2em;
      color: #f3e5f5;
      margin-bottom: 20px;
      font-style: italic;
      line-height: 1.4;
    }

    .submenu {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
      margin: 15px 0;
      overflow-x: auto;
      padding-bottom: 5px;
      scrollbar-width: none;
    }

    .submenu::-webkit-scrollbar {
      display: none;
    }

    .submenu-item {
      background: rgba(50, 20, 80, 0.6);
      border: 2px solid #9c27b0;
      border-radius: 18px;
      padding: 10px 15px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1.1em;
      min-width: 120px;
      white-space: nowrap;
    }

    .submenu-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 0 15px rgba(156, 39, 176, 0.4);
      background: rgba(60, 30, 90, 0.8);
    }

    .submenu-item.active {
      background: rgba(60, 30, 90, 0.9);
      border-color: #e1bee7;
      box-shadow: 0 0 20px rgba(225, 190, 231, 0.5);
      font-weight: bold;
    }

    .section-content {
      display: none;
    }

    .profile-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 20px 0;
    }

    .avatar-container {
      position: relative;
      width: 120px;
      height: 120px;
      margin-bottom: 15px;
    }

    .avatar {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid #9c27b0;
      box-shadow: 0 0 12px rgba(156, 39, 176, 0.5);
    }

    .avatar-upload {
      position: absolute;
      bottom: 5px;
      right: 5px;
      width: 30px;
      height: 30px;
      background: #9c27b0;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 0 8px rgba(0, 0, 0, 0.4);
    }

    .avatar-upload:hover {
      background: #7b1fa2;
      transform: scale(1.05);
    }

    .input-group {
      width: 100%;
      max-width: 100%;
      margin: 12px 0;
    }

    .input-label {
      display: block;
      text-align: left;
      margin-bottom: 6px;
      color: #e1bee7;
      font-weight: bold;
      font-size: 1.05em;
    }

    .input-field {
      width: 100%;
      padding: 10px;
      background: rgba(50, 20, 80, 0.5);
      border: 1px solid #9c27b0;
      border-radius: 8px;
      color: #f3e5f5;
      font-family: 'Caveat', cursive;
      font-size: 1.05em;
    }

    .input-field:focus {
      outline: none;
      border-color: #e1bee7;
      box-shadow: 0 0 8px rgba(225, 190, 231, 0.3);
    }

    .radio-group {
      display: flex;
      gap: 12px;
      margin: 12px 0;
      justify-content: center;
      flex-wrap: wrap;
    }

    .radio-option {
      display: flex;
      align-items: center;
      gap: 4px;
      flex: 1;
      min-width: 80px;
    }

    .radio-input {
      display: none;
    }

    .radio-label {
      background: rgba(50, 20, 80, 0.6);
      border: 1px solid #9c27b0;
      border-radius: 18px;
      padding: 6px 12px;
      cursor: pointer;
      transition: all 0.25s ease;
      width: 100%;
      text-align: center;
      font-size: 0.95em;
    }

    .radio-input:checked + .radio-label {
      background: #9c27b0;
      border-color: #e1bee7;
      box-shadow: 0 0 8px rgba(156, 39, 176, 0.4);
    }

    .question-container {
      background: rgba(30, 10, 60, 0.7);
      border: 1px solid #9c27b0;
      border-radius: 16px;
      padding: 20px;
      margin: 20px 0;
      min-height: 250px;
      box-shadow: inset 0 0 12px rgba(156, 39, 176, 0.3);
      position: relative;
      overflow: hidden;
    }

    .question-title {
      font-family: 'Playfair Display', serif;
      color: #e1bee7;
      font-size: 1.5em;
      margin-bottom: 15px;
      text-shadow: 0 0 8px rgba(225, 190, 231, 0.4);
    }

    .answers {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    .answer-btn {
      background: rgba(50, 20, 80, 0.6);
      color: #f3e5f5;
      border: 1px solid #9c27b0;
      border-radius: 12px;
      padding: 10px;
      font-size: 1.05em;
      font-family: 'Caveat', cursive;
      cursor: pointer;
      transition: all 0.25s ease;
      text-align: left;
    }

    .answer-btn:hover {
      background: rgba(60, 30, 90, 0.7);
      transform: translateY(-2px);
      box-shadow: 0 0 8px rgba(156, 39, 176, 0.4);
    }

    .answer-btn.selected {
      background: #9c27b0;
      border-color: #e1bee7;
      box-shadow: 0 0 10px rgba(156, 39, 176, 0.5);
    }

    .results-container {
      background: rgba(30, 10, 60, 0.7);
      border: 1px solid #9c27b0;
      border-radius: 16px;
      padding: 20px;
      margin: 20px 0;
      min-height: 300px;
      box-shadow: inset 0 0 12px rgba(156, 39, 176, 0.3);
      position: relative;
      overflow: hidden;
    }

    .compatibility-score {
      font-family: 'Playfair Display', serif;
      color: #e1bee7;
      font-size: 2.8em;
      margin: 15px 0;
      text-shadow: 0 0 12px rgba(156, 39, 176, 0.6);
    }

    .compatibility-desc {
      color: #f3e5f5;
      font-size: 1.15em;
      line-height: 1.5;
      margin-bottom: 20px;
    }

    .match-notification {
      background: rgba(50, 20, 80, 0.7);
      border: 1px solid #9c27b0;
      border-radius: 15px;
      padding: 15px;
      margin: 15px 0;
      text-align: center;
    }

    .match-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      margin: 0 auto 10px;
      border: 2px solid #9c27b0;
    }

    .match-name {
      font-weight: bold;
      color: #e1bee7;
      font-size: 1.2em;
      margin-bottom: 5px;
    }

    .match-compatibility {
      color: #f3e5f5;
      font-size: 0.95em;
      margin-bottom: 10px;
    }

    .match-city {
      background: rgba(156, 39, 176, 0.2);
      border: 1px solid #9c27b0;
      border-radius: 8px;
      padding: 3px 8px;
      font-size: 0.85em;
      margin-top: 5px;
      display: inline-block;
    }

    .match-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .btn-match {
      flex: 1;
      padding: 10px;
      border-radius: 12px;
      border: none;
      font-family: 'Caveat', cursive;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-accept {
      background: #4caf50;
      color: white;
    }

    .btn-decline {
      background: #f44336;
      color: white;
    }

    .chat-container {
      display: flex;
      flex-direction: column;
      height: 450px;
    }

    .chat-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 12px;
      background: rgba(50, 20, 80, 0.5);
      border-radius: 12px 12px 0 0;
      border-bottom: 1px solid #9c27b0;
    }

    .chat-title {
      font-weight: bold;
      color: #e1bee7;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 1.1em;
    }

    .chat-city-tag {
      background: rgba(156, 39, 176, 0.3);
      border: 1px solid #9c27b0;
      border-radius: 8px;
      padding: 2px 6px;
      font-size: 0.75em;
    }

    .chat-members {
      display: flex;
      gap: 4px;
    }

    .member-avatar {
      width: 25px;
      height: 25px;
      border-radius: 50%;
      object-fit: cover;
      border: 1px solid #9c27b0;
    }

    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 12px;
      background: rgba(30, 10, 60, 0.5);
      border-left: 1px solid #9c27b0;
      border-right: 1px solid #9c27b0;
    }

    .message {
      margin-bottom: 12px;
      max-width: 85%;
    }

    .message.self {
      margin-left: auto;
    }

    .message-content {
      background: rgba(60, 30, 90, 0.8);
      color: #f3e5f5;
      padding: 8px 12px;
      border-radius: 12px 12px 0 12px;
      position: relative;
      font-size: 1.05em;
    }

    .message.self .message-content {
      background: #9c27b0;
      border-radius: 12px 12px 12px 0;
    }

    .message-time {
      font-size: 0.65em;
      color: #b0bec5;
      text-align: right;
      margin-top: 3px;
    }

    .message-image {
      max-width: 100%;
      max-height: 150px;
      border-radius: 8px;
      margin-top: 4px;
    }

    .chat-input {
      display: flex;
      gap: 8px;
      padding: 8px 12px;
      background: rgba(50, 20, 80, 0.5);
      border-radius: 0 0 12px 12px;
      border-top: 1px solid #9c27b0;
    }

    .chat-input-field {
      flex: 1;
      padding: 10px;
      background: rgba(30, 10, 60, 0.7);
      border: 1px solid #9c27b0;
      border-radius: 8px;
      color: #f3e5f5;
      font-family: 'Caveat', cursive;
    }

    .chat-input-field:focus {
      outline: none;
      border-color: #e1bee7;
    }

    .chat-input-actions {
      display: flex;
      gap: 8px;
    }

    .chat-btn {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      background: rgba(50, 20, 80, 0.6);
      border: 1px solid #9c27b0;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.25s ease;
    }

    .chat-btn:hover {
      background: #9c27b0;
      transform: scale(1.05);
    }

    .friends-list {
      max-height: 350px;
      overflow-y: auto;
    }

    .friend-item {
      background: rgba(50, 20, 80, 0.5);
      border: 1px solid #9c27b0;
      border-radius: 12px;
      padding: 12px;
      margin: 10px 0;
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      transition: all 0.25s ease;
    }

    .friend-item:hover {
      background: rgba(60, 30, 90, 0.7);
      transform: translateY(-2px);
    }

    .friend-avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid #9c27b0;
    }

    .friend-info {
      flex: 1;
      text-align: left;
    }

    .friend-name {
      font-weight: bold;
      color: #e1bee7;
      margin-bottom: 3px;
    }

    .friend-status {
      font-size: 0.85em;
      color: #b0bec5;
    }

    .friend-actions {
      display: flex;
      gap: 8px;
    }

    .btn-chat {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: rgba(156, 39, 176, 0.3);
      border: 1px solid #9c27b0;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .progress-bar {
      height: 6px;
      background: rgba(50, 20, 80, 0.5);
      border-radius: 3px;
      margin: 15px 0;
      overflow: hidden;
    }

    .progress {
      height: 100%;
      background: #9c27b0;
      width: 0%;
      transition: width 0.4s ease;
    }

    .warning {
      background: rgba(156, 39, 176, 0.2);
      border: 1px solid #9c27b0;
      border-radius: 8px;
      padding: 8px;
      margin: 8px 0;
      color: #f3e5f5;
      font-size: 0.85em;
      text-align: left;
    }

    .baba-message {
      background: rgba(50, 20, 80, 0.5);
      border: 1px solid #9c27b0;
      border-radius: 12px;
      padding: 12px;
      margin: 10px 0;
      text-align: center;
      font-style: italic;
      color: #d1c4e9;
      font-size: 0.95em;
    }

    .nav-buttons {
      margin: 20px auto 10px;
      display: flex;
      justify-content: space-between;
      max-width: 100%;
      flex-wrap: wrap;
      gap: 10px;
    }

    .btn-back, .btn-home, .btn-next, .btn-prev {
      display: inline-block;
      padding: 10px 15px;
      background: rgba(225, 190, 231, 0.25);
      color: #e1bee7;
      text-decoration: none;
      border: 1px solid #e1bee7;
      border-radius: 10px;
      font-size: 1.05em;
      font-family: 'Caveat', cursive;
      transition: all 0.3s ease;
      box-shadow: 0 0 8px rgba(225, 190, 231, 0.3);
      min-width: 120px;
      flex: 1;
    }

    .btn-back:hover, .btn-home:hover, .btn-next:hover, .btn-prev:hover {
      background: rgba(225, 190, 231, 0.4);
      transform: scale(1.03);
      box-shadow: 0 0 10px rgba(225, 190, 231, 0.4);
    }

    .spiral {
      position: absolute;
      top: 5px;
      right: 5px;
      width: 40px;
      height: 40px;
      background: 
        radial-gradient(circle at 20px 20px, transparent 1.5px, #9c27b0 2px, transparent 2.5px),
        linear-gradient(45deg, transparent 20px, #9c27b0 21px, #9c27b0 22px, transparent 23px),
        linear-gradient(135deg, transparent 20px, #9c27b0 21px, #9c27b0 22px, transparent 23px);
      opacity: 0.2;
    }

    .seal {
      position: absolute;
      bottom: 5px;
      right: 5px;
      width: 30px;
      height: 30px;
      background: radial-gradient(circle, #9c27b0, #4a148c);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 0.6em;
      opacity: 0.6;
    }

    .page-transition {
      animation: pageSlide 0.4s ease;
    }

    @keyframes pageSlide {
      from { opacity: 0; transform: translateX(15px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .story-animation {
      animation: storyAppear 0.6s ease;
    }

    @keyframes storyAppear {
      0% { opacity: 0; transform: scale(0.95); }
      100% { opacity: 1; transform: scale(1); }
    }

    .loading {
      display: none;
      text-align: center;
      padding: 15px;
    }

    .spinner {
      border: 3px solid rgba(156, 39, 176, 0.3);
      border-radius: 50%;
      border-top: 3px solid #9c27b0;
      width: 30px;
      height: 30px;
      animation: spin 1s linear infinite;
      margin: 0 auto 10px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .empty-message {
      background: rgba(50, 20, 80, 0.5);
      border: 1px solid #9c27b0;
      border-radius: 12px;
      padding: 15px;
      margin: 15px 0;
      color: #e1bee7;
      font-size: 1.1em;
    }

    .baba-rules {
      background: rgba(50, 20, 80, 0.4);
      border: 1px solid #9c27b0;
      border-radius: 12px;
      padding: 12px;
      margin: 10px 0;
      font-size: 0.9em;
      color: #d1c4e9;
      text-align: left;
    }

    .baba-rules li {
      margin-bottom: 5px;
      line-height: 1.3;
    }

    .baba-humor {
      font-style: italic;
      color: #ff9800;
      margin-top: 8px;
      font-size: 0.95em;
    }

    /* Mobile-specific styles */
    @media (max-width: 480px) {
      .container {
        padding: 15px 10px;
        border-radius: 16px;
      }
      
      h1 {
        font-size: 1.7em;
      }
      
      .input-field, .answer-btn, .btn-match, .chat-input-field {
        font-size: 1em;
      }
      
      .question-title {
        font-size: 1.35em;
      }
      
      .compatibility-score {
        font-size: 2.3em;
      }
      
      .chat-container {
        height: 400px;
      }
    }
  </style>
</head>
<body>
  <div class="stars" id="stars"></div>
  
  <div class="page">
    <!-- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è -->
    <div id="registration" class="container">
      <h1>ü§ù –ü–æ–∑–Ω–∞–∫–æ–º–∏–º—Å—è</h1>
      <p class="subtitle">–ú–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞ –æ—Ç –±–∞–±—ã –ú–∞—à–∏</p>
      
      <div class="profile-section">
        <div class="avatar-container">
          <img src="https://placehold.co/120x120/4a148c/9c27b0?text=–í—ã" alt="–í–∞—à –∞–≤–∞—Ç–∞—Ä" class="avatar" id="reg-avatar">
          <div class="avatar-upload" onclick="document.getElementById('reg-avatar-input').click()">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="white" viewBox="0 0 16 16">
              <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
              <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z"/>
            </svg>
          </div>
          <input type="file" id="reg-avatar-input" accept="image/*" style="display: none;" onchange="updateRegAvatar(event)">
        </div>
        
        <div class="input-group">
          <label class="input-label">–í–∞—à –Ω–∏–∫–Ω–µ–π–º</label>
          <input type="text" class="input-field" id="reg-username" placeholder="–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç, –¥–æ—Ä–æ–≥–æ–π?" value="–ê–Ω–Ω–∞">
        </div>
        
        <div class="input-group">
          <label class="input-label">–í–∞—à –≥–æ—Ä–æ–¥</label>
          <input type="text" class="input-field" id="reg-city" placeholder="–í–∞—à –≥–æ—Ä–æ–¥ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è" value="–ú–æ—Å–∫–≤–∞">
        </div>
        
        <div class="input-group">
          <label class="input-label">–í–∞—à –ø–æ–ª</label>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" id="reg-gender-female" name="reg-gender" class="radio-input" checked>
              <label for="reg-gender-female" class="radio-label">‚ôÄ –î–µ–≤—É—à–∫–∞</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="reg-gender-male" name="reg-gender" class="radio-input">
              <label for="reg-gender-male" class="radio-label">‚ôÇ –ü–∞—Ä–µ–Ω—å</label>
            </div>
          </div>
        </div>
        
        <div class="warning">
          <strong>–í–Ω–∏–º–∞–Ω–∏–µ!</strong> –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—è—Å—å, –≤—ã —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –æ–±—â–µ–Ω–∏—è –≤ –Ω–∞—à–µ–º —Å–æ–æ–±—â–µ—Å—Ç–≤–µ.
        </div>
        
        <button class="btn-next" onclick="registerUser()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
      </div>
    </div>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
    <div id="main-app" class="container" style="display: none;">
      <h1>–ú–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞</h1>
      <p class="subtitle">–ù–∞–π–¥–∏—Ç–µ —Å–≤–æ—é –¥—É—Ö–æ–≤–Ω—É—é –ø–∞—Ä—É —Å –ø–æ–º–æ—â—å—é –±–∞–±—ã –ú–∞—à–∏</p>
      
      <div class="submenu">
        <div class="submenu-item active" onclick="showSection('friends')">–ú–æ–∏ –¥—Ä—É–∑—å—è</div>
        <div class="submenu-item" onclick="showSection('compatibility-test')">–¢–µ—Å—Ç –Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å</div>
        <div class="submenu-item" onclick="showSection('chat')">–ß–∞—Ç</div>
      </div>
      
      <!-- –°–µ–∫—Ü–∏—è "–ú–æ–∏ –¥—Ä—É–∑—å—è" -->
      <div id="friends" class="section-content active">
        <div class="empty-message" id="friends-empty">
          <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –¥—Ä—É–∑–µ–π.</p>
          <p>–ü—Ä–æ–π–¥–∏—Ç–µ —Ç–µ—Å—Ç –Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–æ–≤!</p>
        </div>
        
        <div class="friends-list" id="friends-list" style="display: none;">
          <div class="friend-item" onclick="openChat(1)">
            <img src="https://placehold.co/50x50/4a148c/9c27b0?text=–ê" alt="–ê–ª–µ–∫—Å–µ–π" class="friend-avatar">
            <div class="friend-info">
              <div class="friend-name">–ê–ª–µ–∫—Å–µ–π</div>
              <div class="friend-status">–æ–Ω–ª–∞–π–Ω ‚Ä¢ –ú–æ—Å–∫–≤–∞</div>
            </div>
            <div class="friend-actions">
              <div class="btn-chat" title="–ù–∞–ø–∏—Å–∞—Ç—å">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#e1bee7" viewBox="0 0 16 16">
                  <path d="M15.964.686a.5.5 0 0 0-.65-.65L.767 5.855H.766l-.452.19a.5.5 0 0 0-.082.887l.41.26.001.002 4.995 3.178 3.178 4.995.002.001.26.41a.5.5 0 0 0 .886-.083l6-15Zm-1.833 1.89L6.637 10.07l-.215-.338a.5.5 0 0 0-.156-.257L5.509 9.02l.932-.562 1.222 1.834a.5.5 0 0 0 .755.157l5.11-6.813-1.897 1.897-.896.896 2.012 1.263-.896.896-1.263-2.012-.375.375.375.375-1.274 1.274Z"/>
                </svg>
              </div>
            </div>
          </div>
          
          <div class="friend-item" onclick="openChat(2)">
            <img src="https://placehold.co/50x50/4a148c/9c27b0?text=–°" alt="–°–æ—Ñ–∏—è" class="friend-avatar">
            <div class="friend-info">
              <div class="friend-name">–°–æ—Ñ–∏—è</div>
              <div class="friend-status">–±—ã–ª(–∞) 15 –º–∏–Ω –Ω–∞–∑–∞–¥ ‚Ä¢ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥</div>
            </div>
            <div class="friend-actions">
              <div class="btn-chat" title="–ù–∞–ø–∏—Å–∞—Ç—å">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#e1bee7" viewBox="0 0 16 16">
                  <path d="M15.964.686a.5.5 0 0 0-.65-.65L.767 5.855H.766l-.452.19a.5.5 0 0 0-.082.887l.41.26.001.002 4.995 3.178 3.178 4.995.002.001.26.41a.5.5 0 0 0 .886-.083l6-15Zm-1.833 1.89L6.637 10.07l-.215-.338a.5.5 0 0 0-.156-.257L5.509 9.02l.932-.562 1.222 1.834a.5.5 0 0 0 .755.157l5.11-6.813-1.897 1.897-.896.896 2.012 1.263-.896.896-1.263-2.012-.375.375.375.375-1.274 1.274Z"/>
                </svg>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- –°–µ–∫—Ü–∏—è "–¢–µ—Å—Ç –Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å" -->
      <div id="compatibility-test" class="section-content">
        <!-- –¢–µ—Å—Ç –Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å -->
        <div id="test-questions" style="display: block;">
          <div class="progress-bar">
            <div class="progress" id="test-progress" style="width: 0%;"></div>
          </div>
          
          <div class="question-container">
            <h2 class="question-title" id="question-title">–ö–∞–∫–æ–π –≤–∞—à –ª—é–±–∏–º—ã–π —Å–ø–æ—Å–æ–± –ø—Ä–æ–≤–µ—Å—Ç–∏ –≤–µ—á–µ—Ä?</h2>
            
            <div class="answers" id="answers-container">
              <button class="answer-btn" onclick="selectAnswer(this, 1)">–£–µ–¥–∏–Ω–∏—Ç—å—Å—è —Å –∫–Ω–∏–≥–æ–π –∏–ª–∏ —Ñ–∏–ª—å–º–æ–º</button>
              <button class="answer-btn" onclick="selectAnswer(this, 2)">–í—Å—Ç—Ä–µ—Ç–∏—Ç—å—Å—è —Å –¥—Ä—É–∑—å—è–º–∏</button>
              <button class="answer-btn" onclick="selectAnswer(this, 3)">–ó–∞–Ω—è—Ç—å—Å—è —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ–º –∏–ª–∏ —Ö–æ–±–±–∏</button>
              <button class="answer-btn" onclick="selectAnswer(this, 4)">–ü—Ä–æ–≥—É–ª—è—Ç—å—Å—è –ø–æ–¥ –ª—É–Ω–æ–π</button>
            </div>
          </div>
          
          <button class="btn-next" id="next-question-btn" onclick="nextQuestion()" style="display: none;">–°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å ‚Üí</button>
        </div>
        
        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ -->
        <div id="test-results" style="display: none;" class="results-container">
          <h2 class="story-title">–í–∞—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏</h2>
          
          <div class="compatibility-score" id="compatibility-score">85%</div>
          
          <p class="compatibility-desc" id="compatibility-desc">
            –ë–∞–±–∞ –ú–∞—à–∞ –∑–∞–≥–ª—è–Ω—É–ª–∞ –≤ –∫—Ä–∏—Å—Ç–∞–ª—å–Ω—É—é —Å—Ñ–µ—Ä—É –∏ —É–≤–∏–¥–µ–ª–∞, —á—Ç–æ —É –≤–∞—Å –ø—Ä–µ–∫—Ä–∞—Å–Ω–∞—è —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ª—é–¥—å–º–∏ –≤ –Ω–∞—à–µ–º —Å–æ–æ–±—â–µ—Å—Ç–≤–µ! 
            –í—ã —Ü–µ–Ω–∏—Ç–µ –∏—Å–∫—Ä–µ–Ω–Ω–æ—Å—Ç—å –∏ –¥—É—à–µ–≤–Ω—ã–µ —Ä–∞–∑–≥–æ–≤–æ—Ä—ã, —á—Ç–æ —Ä–µ–¥–∫–æ—Å—Ç—å –≤ –Ω–∞—à–µ –≤—Ä–µ–º—è. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –±—ã—Ç—å —Å–æ–±–æ–π!
          </p>
          
          <div class="baba-message">
            "–ú–∏–ª–æ—á–∫–∏, –≤–Ω—É—á–∞—Ç–∞! –ü–æ–º–Ω–∏—Ç–µ: –∏—Å—Ç–∏–Ω–∞ –≤ –¥—É—à–µ, –∞ –Ω–µ –≤ –≥–ª–∞–∑–∞—Ö. –ù–µ —Å–ø–µ—à–∏—Ç–µ —Å –≤—ã–≤–æ–¥–∞–º–∏, –¥–∞–π—Ç–µ —Å–µ–±–µ –∏ –¥—Ä—É–≥–æ–º—É —á–µ–ª–æ–≤–µ–∫—É —à–∞–Ω—Å —É–∑–Ω–∞—Ç—å –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –ø–æ–ª—É—á—à–µ!"
          </div>
          
          <div class="baba-humor">
            "–ê –ø–æ–º–Ω–∏—Ç–µ, –∫–∞–∫ —è –≤–∞–º –≥–æ–≤–æ—Ä–∏–ª–∞: '–ù–µ —Å—É–¥–∏ –ø–æ –æ–±–ª–æ–∂–∫–µ, –º–æ–∂–µ—Ç, —Ç–∞–º –≤–Ω—É—Ç—Ä–∏ - —Å—á–∞—Å—Ç—å–µ!'"
          </div>
        </div>
        
        <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ -->
        <div id="match-notification" style="display: none;" class="match-notification">
          <img src="https://placehold.co/80x80/4a148c/9c27b0?text=–ê" alt="–ê–ª–µ–∫—Å–µ–π" class="match-avatar">
          <div class="match-name">–ê–ª–µ–∫—Å–µ–π</div>
          <div class="match-compatibility">82% —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å</div>
          <div class="match-city">–ú–æ—Å–∫–≤–∞</div>
          
          <p style="color: #f3e5f5; margin: 10px 0;">–ë–∞–±–∞ –ú–∞—à–∞ –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ –≤—ã –ø–æ–¥—Ö–æ–¥–∏—Ç–µ –¥—Ä—É–≥ –¥—Ä—É–≥—É!</p>
          
          <p style="color: #e1bee7; font-weight: bold; margin-bottom: 15px;">
            –ê–ª–µ–∫—Å–µ–π –∏–∑ –ú–æ—Å–∫–≤—ã —Ö–æ—á–µ—Ç —Å –≤–∞–º–∏ –ø–æ–æ–±—â–∞—Ç—å—Å—è. –ù–µ –∂–µ–ª–∞–µ—Ç–µ –æ—Ç–≤–µ—Ç–∏—Ç—å?
          </p>
          
          <div class="match-actions">
            <button class="btn-match btn-accept" onclick="acceptMatch()">–ü–æ—á–∞—Ç–∞—Ç—å—Å—è</button>
            <button class="btn-match btn-decline" onclick="declineMatch()">–ü–æ—Ç–æ–º</button>
          </div>
          
          <div class="baba-rules">
            <p style="margin-bottom: 8px; color: #e1bee7;">–ü—Ä–∞–≤–∏–ª–∞ –æ–±—â–µ–Ω–∏—è –æ—Ç –±–∞–±—ã –ú–∞—à–∏:</p>
            <ul>
              <li>–û–±—â–∞–π—Ç–µ—Å—å —É–≤–∞–∂–∏—Ç–µ–ª—å–Ω–æ, –∫–∞–∫ —Å —Ä–æ–¥–Ω—ã–º–∏</li>
              <li>–ù–µ —Å–ø—Ä–∞—à–∏–≤–∞–π—Ç–µ –ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å—Ä–∞–∑—É</li>
              <li>–¶–µ–Ω–∏—Ç–µ –≤—Ä–µ–º—è –¥—Ä—É–≥ –¥—Ä—É–≥–∞</li>
              <li>–ù–µ –æ–±–∏–∂–∞–π—Ç–µ —Å–ª–æ–≤–æ–º - —Å–ª–æ–≤–∞ –Ω–µ –≤–æ—Ä–æ–±–µ–π</li>
            </ul>
            <div class="baba-humor" style="margin-top: 8px;">
              "–ê –ø–æ–º–Ω–∏—Ç–µ, –∫–∞–∫ —è –≤–∞–º –≥–æ–≤–æ—Ä–∏–ª–∞: '–ù–µ —Å—É–¥–∏ –ø–æ –æ–±–ª–æ–∂–∫–µ, –º–æ–∂–µ—Ç, —Ç–∞–º –≤–Ω—É—Ç—Ä–∏ - —Å—á–∞—Å—Ç—å–µ!'"
            </div>
          </div>
        </div>
      </div>
      
      <!-- –°–µ–∫—Ü–∏—è "–ß–∞—Ç" -->
      <div id="chat" class="section-content">
        <div class="empty-message" id="chat-empty">
          <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —á–∞—Ç–æ–≤.</p>
          <p>–ù–∞–π–¥–∏—Ç–µ –¥—Ä—É–∑–µ–π —á–µ—Ä–µ–∑ —Ç–µ—Å—Ç –Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å!</p>
        </div>
        
        <div id="chat-content" style="display: none;">
          <div class="baba-message" id="baba-welcome">
            –î–æ—Ä–æ–≥–∏–µ –º–æ–∏ –≤–Ω—É—á–∞—Ç–∞! –ü–æ–º–Ω–∏—Ç–µ: –æ–±—â–µ–Ω–∏–µ - —ç—Ç–æ –∫–∞–∫ —á–∞–π–Ω–∏–∫ - –∫–∏–ø–∏—Ç, –∫–æ–≥–¥–∞ –≤ –Ω–µ–º —Ç–µ–ø–ª–æ –∏ —É–≤–∞–∂–µ–Ω–∏–µ. 
            –ù–µ —Å–ø–µ—à–∏—Ç–µ —Å –≤—ã–≤–æ–¥–∞–º–∏, –¥–∞–π—Ç–µ –¥—Ä—É–≥ –¥—Ä—É–≥—É –≤—Ä–µ–º—è —É–∑–Ω–∞—Ç—å —Å–µ—Ä–¥—Ü–∞. –ò –ø–æ–º–Ω–∏—Ç–µ: "–ù–µ —Å—É–¥–∏ –ø–æ –æ–±–ª–æ–∂–∫–µ, –º–æ–∂–µ—Ç, —Ç–∞–º –≤–Ω—É—Ç—Ä–∏ - —Å—á–∞—Å—Ç—å–µ!"
          </div>
          
          <div class="chat-container" id="active-chat" style="display: none;">
            <div class="chat-header">
              <div class="chat-title" id="chat-title">
                –ê–ª–µ–∫—Å–µ–π
                <span class="chat-city-tag">–ú–æ—Å–∫–≤–∞</span>
              </div>
              <div class="chat-members">
                <img src="https://placehold.co/25x25/4a148c/9c27b0?text=–í" alt="–í–∞—à –∞–≤–∞—Ç–∞—Ä" class="member-avatar">
                <img src="https://placehold.co/25x25/4a148c/9c27b0?text=–ê" alt="–ê–≤–∞—Ç–∞—Ä —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞" class="member-avatar">
              </div>
            </div>
            
            <div class="chat-messages" id="chat-messages">
              <div class="message">
                <div class="message-content">
                  –ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ —Ç–≤–æ–∏ –¥–µ–ª–∞? –ë–∞–±–∞ –ú–∞—à–∞ —Å–µ–≥–æ–¥–Ω—è –ø–æ–¥—Å–∫–∞–∑–∞–ª–∞ –º–Ω–µ, —á—Ç–æ —Ç—ã –∏—â–µ—à—å —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞ –¥–ª—è –¥—É—à–µ–≤–Ω—ã—Ö —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤.
                </div>
                <div class="message-time">10:25</div>
              </div>
              
              <div class="message self">
                <div class="message-content">
                  –ü—Ä–∏–≤–µ—Ç! –î–∞, —è –∫–∞–∫ —Ä–∞–∑ —Ö–æ—Ç–µ–ª(–∞) –ø–æ–æ–±—â–∞—Ç—å—Å—è. –°–µ–≥–æ–¥–Ω—è –±–∞–±–∞ –ú–∞—à–∞ –ø–æ—Å–æ–≤–µ—Ç–æ–≤–∞–ª–∞ –º–Ω–µ –Ω–∞–π—Ç–∏ –Ω–æ–≤–æ–≥–æ –¥—Ä—É–≥–∞.
                </div>
                <div class="message-time">10:27</div>
              </div>
              
              <div class="message">
                <div class="message-content">
                  –û—Ç–ª–∏—á–Ω–æ! –Ø —Ç–æ–∂–µ –≤–µ—Ä—é –≤ –º—É–¥—Ä–æ—Å—Ç—å –±–∞–±—ã –ú–∞—à–∏. –û–Ω–∞ –º–Ω–µ —Å–µ–≥–æ–¥–Ω—è —Å–∫–∞–∑–∞–ª–∞, —á—Ç–æ —è –Ω–∞–π–¥—É —á–µ–ª–æ–≤–µ–∫–∞, —Å –∫–æ—Ç–æ—Ä—ã–º —Å–º–æ–≥—É –≥–æ–≤–æ—Ä–∏—Ç—å –æ–±–æ –≤—Å—ë–º.
                </div>
                <div class="message-time">10:28</div>
              </div>
            </div>
            
            <div class="chat-input">
              <input type="text" class="chat-input-field" id="message-input" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
              <div class="chat-input-actions">
                <div class="chat-btn" onclick="document.getElementById('photo-input').click()">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#e1bee7" viewBox="0 0 16 16">
                    <path d="M.165 8.662a.5.5 0 0 0 .589.372l6.047-.807 1.968 1.968-.807 6.047a.5.5 0 0 0 .372.589l.5.166a.5.5 0 0 0 .5-.166l6.047-8.063a.5.5 0 0 0 0-.628L8 2.223a.5.5 0 0 0-.5.166L.663 8.165a.5.5 0 0 0-.5.166l-.166.5Z"/>
                  </svg>
                </div>
                <input type="file" id="photo-input" accept="image/*" style="display: none;" onchange="sendPhoto(event)">
                <div class="chat-btn" onclick="sendMessage()">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#e1bee7" viewBox="0 0 16 16">
                    <path d="M15.964.686a.5.5 0 0 0-.65-.65L.767 5.855H.766l-.452.19a.5.5 0 0 0-.082.887l.41.26.001.002 4.995 3.178 3.178 4.995.002.001.26.41a.5.5 0 0 0 .886-.083l6-15Zm-1.833 1.89L6.637 10.07l-.215-.338a.5.5 0 0 0-.156-.257L5.509 9.02l.932-.562 1.222 1.834a.5.5 0 0 0 .755.157l5.11-6.813-1.897 1.897-.896.896 2.012 1.263-.896.896-1.263-2.012-.375.375.375.375-1.274 1.274Z"/>
                  </svg>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="nav-buttons">
        <a href="#" class="btn-back" onclick="goBack()" style="display: none;">‚¨ÖÔ∏è –ù–∞–∑–∞–¥</a>
        <a href="index.html" class="btn-home">üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</a>
      </div>
    </div>
  </div>

  <script>
    // –°–æ–∑–¥–∞–µ–º –º–µ—Ä—Ü–∞—é—â–∏–µ –∑–≤–µ–∑–¥—ã
    function createStars() {
      const starsContainer = document.getElementById('stars');
      const starCount = 80;
      
      for (let i = 0; i < starCount; i++) {
        const star = document.createElement('div');
        star.classList.add('star');
        
        // –°–ª—É—á–∞–π–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∑–≤–µ–∑–¥
        const size = Math.random() * 2.5;
        const posX = Math.random() * 100;
        const posY = Math.random() * 100;
        const delay = Math.random() * 4;
        const duration = 2 + Math.random() * 4;
        
        star.style.width = `${size}px`;
        star.style.height = `${size}px`;
        star.style.left = `${posX}%`;
        star.style.top = `${posY}%`;
        star.style.animationDelay = `${delay}s`;
        star.style.animationDuration = `${duration}s`;
        
        starsContainer.appendChild(star);
      }
    }
    
    // –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    let userData = {
      id: null,
      avatar: 'https://placehold.co/120x120/4a148c/9c27b0?text=–í—ã',
      username: '',
      city: '',
      gender: '',
      answers: [],
      friends: [],
      currentChat: null
    };
    
    // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏
    const allUsers = [
      {
        id: 1,
        avatar: "https://placehold.co/80x80/4a148c/9c27b0?text=–ê",
        name: "–ê–ª–µ–∫—Å–µ–π",
        city: "–ú–æ—Å–∫–≤–∞",
        gender: "male",
        compatibility: 82,
        isLocal: true,
        status: "online"
      },
      {
        id: 2,
        avatar: "https://placehold.co/80x80/4a148c/9c27b0?text=–°",
        name: "–°–æ—Ñ–∏—è",
        city: "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
        gender: "female",
        compatibility: 76,
        isLocal: false,
        status: "offline"
      },
      {
        id: 3,
        avatar: "https://placehold.co/80x80/4a148c/9c27b0?text=–ú",
        name: "–ú–∏—Ö–∞–∏–ª",
        city: "–ú–æ—Å–∫–≤–∞",
        gender: "male",
        compatibility: 78,
        isLocal: true,
        status: "online"
      },
      {
        id: 4,
        avatar: "https://placehold.co/80x80/4a148c/9c27b0?text=–ö",
        name: "–ö–∞—Ç—è",
        city: "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
        gender: "female",
        compatibility: 72,
        isLocal: false,
        status: "offline"
      }
    ];
    
    // –î–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç–∞
    let compatibilityTest = {
      currentQuestion: 0,
      questions: [
        {
          text: "–ö–∞–∫–æ–π –≤–∞—à –ª—é–±–∏–º—ã–π —Å–ø–æ—Å–æ–± –ø—Ä–æ–≤–µ—Å—Ç–∏ –≤–µ—á–µ—Ä?",
          answers: [
            "–£–µ–¥–∏–Ω–∏—Ç—å—Å—è —Å –∫–Ω–∏–≥–æ–π –∏–ª–∏ —Ñ–∏–ª—å–º–æ–º",
            "–í—Å—Ç—Ä–µ—Ç–∏—Ç—å—Å—è —Å –¥—Ä—É–∑—å—è–º–∏",
            "–ó–∞–Ω—è—Ç—å—Å—è —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ–º –∏–ª–∏ —Ö–æ–±–±–∏",
            "–ü—Ä–æ–≥—É–ª—è—Ç—å—Å—è –ø–æ–¥ –ª—É–Ω–æ–π"
          ]
        },
        {
          text: "–ß—Ç–æ –≤—ã —Ü–µ–Ω–∏—Ç–µ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –≤ –¥—Ä—É–∂–±–µ?",
          answers: [
            "–ò—Å–∫—Ä–µ–Ω–Ω–æ—Å—Ç—å –∏ —á–µ—Å—Ç–Ω–æ—Å—Ç—å",
            "–û–±—â–∏–µ –∏–Ω—Ç–µ—Ä–µ—Å—ã –∏ —Ö–æ–±–±–∏",
            "–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–æ–ª—á–∞—Ç—å, –Ω–µ —á—É–≤—Å—Ç–≤—É—è –Ω–µ–ª–æ–≤–∫–æ—Å—Ç–∏",
            "–ü–æ–¥–¥–µ—Ä–∂–∫—É –≤ —Ç—Ä—É–¥–Ω—É—é –º–∏–Ω—É—Ç—É"
          ]
        },
        {
          text: "–ö–∞–∫ –≤—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ—Å—å –∫ –º–∏—Å—Ç–∏—á–µ—Å–∫–∏–º —è–≤–ª–µ–Ω–∏—è–º?",
          answers: [
            "–í–µ—Ä—é –∏ —Å—Ç–∞–ª–∫–∏–≤–∞–ª—Å—è(–∞—Å—å) —Å –Ω–∏–º–∏",
            "–°–∫–µ–ø—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–Ω–æ—à—É—Å—å, –Ω–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ",
            "–ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Ä–∏—Ü–∞—é –∏—Ö —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ",
            "–ß—É–≤—Å—Ç–≤—É—é –∏—Ö –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ, –Ω–æ –Ω–µ –ø–æ–Ω–∏–º–∞—é"
          ]
        },
        {
          text: "–ö–∞–∫–æ–π –∞—Å—Ç—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∑–Ω–∞–∫ –≤—ã —Å—á–∏—Ç–∞–µ—Ç–µ –Ω–∞–∏–±–æ–ª–µ–µ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º —Å –≤–∞–º–∏?",
          answers: [
            "–û–≤–µ–Ω",
            "–¢–µ–ª–µ—Ü",
            "–ë–ª–∏–∑–Ω–µ—Ü—ã",
            "–†–∞–∫"
          ]
        },
        {
          text: "–ß—Ç–æ –¥–ª—è –≤–∞—Å –∑–Ω–∞—á–∏—Ç '–¥—É—Ö–æ–≤–Ω–∞—è —Å–≤—è–∑—å'?",
          answers: [
            "–ì–ª—É–±–æ–∫–æ–µ –≤–∑–∞–∏–º–æ–ø–æ–Ω–∏–º–∞–Ω–∏–µ –±–µ–∑ —Å–ª–æ–≤",
            "–û–±—â–∏–µ –≤–∑–≥–ª—è–¥—ã –Ω–∞ –∂–∏–∑–Ω—å –∏ —Ü–µ–Ω–Ω–æ—Å—Ç–∏",
            "–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —ç–º–æ—Ü–∏–∏ –¥—Ä—É–≥ –¥—Ä—É–≥–∞",
            "–ù–µ–≤–µ—Ä–æ—è—Ç–Ω–∞—è —Ö–∏–º–∏—è –∏ –ø—Ä–∏—Ç—è–∂–µ–Ω–∏–µ"
          ]
        },
        {
          text: "–ö–∞–∫–æ–π –º–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç –≤—ã –±—ã —Ö–æ—Ç–µ–ª–∏ –∏–º–µ—Ç—å?",
          answers: [
            "–ö—Ä–∏—Å—Ç–∞–ª—å–Ω—ã–π —à–∞—Ä –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π",
            "–û–±–µ—Ä–µ–≥ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –Ω–µ–≥–∞—Ç–∏–≤–∞",
            "–ö–Ω–∏–≥—É –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π",
            "–ö–∞—Ä—Ç–∞ –∑–≤–µ–∑–¥–Ω–æ–≥–æ –Ω–µ–±–∞ —Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏"
          ]
        },
        {
          text: "–ö–∞–∫ –≤—ã –æ–±—ã—á–Ω–æ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç–µ –≤–∞–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è?",
          answers: [
            "–°–ª—É—à–∞—é –∏–Ω—Ç—É–∏—Ü–∏—é –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –≥–æ–ª–æ—Å",
            "–í–∑–≤–µ—à–∏–≤–∞—é –≤—Å–µ –∑–∞ –∏ –ø—Ä–æ—Ç–∏–≤",
            "–°–æ–≤–µ—Ç—É—é—Å—å —Å –±–ª–∏–∑–∫–∏–º–∏",
            "–ë—Ä–æ—Å–∞—é –∂—Ä–µ–±–∏–π –∏–ª–∏ –≥–∞–¥–∞—é"
          ]
        },
        {
          text: "–ö–∞–∫–æ–π –≤–∞—à –ø–æ–¥—Ö–æ–¥ –∫ –Ω–æ–≤—ã–º –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞–º?",
          answers: [
            "–û—Ç–∫—Ä—ã—Ç –∏ –¥—Ä—É–∂–µ–ª—é–±–µ–Ω –∫–æ –≤—Å–µ–º",
            "–û—Å—Ç–æ—Ä–æ–∂–Ω–æ, —Å–Ω–∞—á–∞–ª–∞ –æ—Ü–µ–Ω–∏–≤–∞—é —á–µ–ª–æ–≤–µ–∫–∞",
            "–¢–æ–ª—å–∫–æ —Å —Ç–µ–º–∏, –∫–æ–≥–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–ª–∏",
            "–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é, —á—Ç–æ–±—ã –∫–æ –º–Ω–µ –ø–æ–¥—Ö–æ–¥–∏–ª–∏"
          ]
        },
        {
          text: "–ß—Ç–æ –≤–∞—Å –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç –≤ –ª—é–¥—è—Ö –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ?",
          answers: [
            "–ò—Ö –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –º–∏—Ä –∏ –º—ã—Å–ª–∏",
            "–í–Ω–µ—à–Ω—è—è –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å",
            "–ß—É–≤—Å—Ç–≤–æ —é–º–æ—Ä–∞",
            "–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ —Å–µ–±–µ"
          ]
        },
        {
          text: "–ö–∞–∫ –≤—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç–µ –∏–¥–µ–∞–ª—å–Ω–æ–µ –ø–µ—Ä–≤–æ–µ —Å–≤–∏–¥–∞–Ω–∏–µ?",
          answers: [
            "–¢–∏—Ö–∏–π –≤–µ—á–µ—Ä —Å —á–∞–µ–º –∏ –¥—É—à–µ–≤–Ω–æ–π –±–µ—Å–µ–¥–æ–π",
            "–ü—Ä–∏–∫–ª—é—á–µ–Ω—á–µ—Å–∫–∞—è –ø—Ä–æ–≥—É–ª–∫–∞ –≤ –Ω–µ–æ–±—ã—á–Ω–æ–º –º–µ—Å—Ç–µ",
            "–ü–æ—Å–µ—â–µ–Ω–∏–µ –∫—É–ª—å—Ç—É—Ä–Ω–æ–≥–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è",
            "–°–ª—É—á–∞–π–Ω–∞—è –≤—Å—Ç—Ä–µ—á–∞ —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –≤–æ–ª—à–µ–±—Å—Ç–≤–æ–º"
          ]
        }
      ]
    };
    
    // –¢–µ–∫—É—â–∞—è —Å–µ–∫—Ü–∏—è
    let currentSection = 'friends';
    let matchProposal = null;
    
    // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
    function updateRegAvatar(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
          document.getElementById('reg-avatar').src = e.target.result;
        }
        
        reader.readAsDataURL(file);
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    function registerUser() {
      // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ
      const username = document.getElementById('reg-username').value.trim() || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
      const city = document.getElementById('reg-city').value.trim() || '–ú–æ—Å–∫–≤–∞';
      const gender = document.querySelector('input[name="reg-gender"]:checked').id.split('-')[2];
      const avatar = document.getElementById('reg-avatar').src;
      
      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID
      const timestamp = new Date().getTime();
      const randomPart = Math.floor(Math.random() * 1000);
      const userId = `user_${timestamp}_${randomPart}`;
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      userData = {
        id: userId,
        avatar: avatar,
        username: username,
        city: city,
        gender: gender,
        answers: [],
        friends: [],
        currentChat: null
      };
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
      document.getElementById('registration').style.display = 'none';
      document.getElementById('main-app').style.display = 'block';
      
      // –ò–º–∏—Ç–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –æ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
      setTimeout(() => {
        showMatchProposal();
      }, 3000);
    }
    
    // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –æ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–µ
    function showMatchProposal() {
      // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —Ç–µ—Ö, –∫—Ç–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ –ø–æ–ª—É
      const targetGender = userData.gender === 'female' ? 'male' : 'female';
      const potentialMatches = allUsers.filter(user => 
        user.gender === targetGender && 
        Math.random() > 0.5 // –ò–º–∏—Ç–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞
      );
      
      if (potentialMatches.length > 0) {
        matchProposal = potentialMatches[0];
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        document.getElementById('test-results').style.display = 'none';
        document.getElementById('match-notification').style.display = 'block';
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–∏
        document.querySelector('#match-notification .match-avatar').src = matchProposal.avatar;
        document.querySelector('#match-notification .match-name').textContent = matchProposal.name;
        document.querySelector('#match-notification .match-compatibility').textContent = `${matchProposal.compatibility}% —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å`;
        document.querySelector('#match-notification .match-city').textContent = matchProposal.city;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏—é —Ç–µ—Å—Ç–∞
        showSection('compatibility-test');
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω—è—Ç–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
    function acceptMatch() {
      // –î–æ–±–∞–≤–ª—è–µ–º –≤ –¥—Ä—É–∑—å—è
      if (!userData.friends.some(f => f.id === matchProposal.id)) {
        userData.friends.push({
          id: matchProposal.id,
          name: matchProposal.name,
          avatar: matchProposal.avatar,
          city: matchProposal.city
        });
        
        // –°–æ–∑–¥–∞–µ–º —á–∞—Ç
        userData.currentChat = matchProposal.id;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        updateFriendsList();
        openChat(matchProposal.id);
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
    function declineMatch() {
      document.getElementById('match-notification').style.display = 'none';
      document.getElementById('test-results').style.display = 'block';
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–µ–∫—Ü–∏–∏
    function showSection(section) {
      // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–µ–∫—Ü–∏–∏
      document.querySelectorAll('.section-content').forEach(el => {
        el.classList.remove('active');
        el.style.display = 'none';
      });
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å–µ–∫—Ü–∏—é
      const sectionElement = document.getElementById(section);
      sectionElement.style.display = 'block';
      sectionElement.classList.add('active');
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –ø—É–Ω–∫—Ç –º–µ–Ω—é
      document.querySelectorAll('.submenu-item').forEach(el => {
        el.classList.remove('active');
      });
      event?.currentTarget?.classList.add('active');
      
      currentSection = section;
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ù–∞–∑–∞–¥"
      document.querySelector('.btn-back').style.display = 'inline-block';
      
      // –°–∫—Ä—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —Å–µ–∫—Ü–∏–∏
      if (section !== 'compatibility-test' && document.getElementById('match-notification').style.display === 'block') {
        document.getElementById('match-notification').style.display = 'none';
      }
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥—Ä—É–∑–µ–π
      if (section === 'friends') {
        updateFriendsList();
      }
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–∞—Ç–∞
      if (section === 'chat') {
        checkChatStatus();
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –¥—Ä—É–∑–µ–π
    function updateFriendsList() {
      const friendsList = document.getElementById('friends-list');
      const friendsEmpty = document.getElementById('friends-empty');
      
      if (userData.friends.length === 0) {
        friendsList.style.display = 'none';
        friendsEmpty.style.display = 'block';
      } else {
        friendsList.style.display = 'block';
        friendsEmpty.style.display = 'none';
        
        // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫
        friendsList.innerHTML = '';
        
        // –î–æ–±–∞–≤–ª—è–µ–º –¥—Ä—É–∑–µ–π
        userData.friends.forEach(friend => {
          const friendElement = document.createElement('div');
          friendElement.className = 'friend-item';
          friendElement.onclick = function() { openChat(friend.id); };
          
          const status = friend.id === userData.currentChat ? '–æ–Ω–ª–∞–π–Ω' : '–±—ã–ª(–∞) –Ω–µ–¥–∞–≤–Ω–æ';
          
          friendElement.innerHTML = `
            <img src="${friend.avatar}" alt="${friend.name}" class="friend-avatar">
            <div class="friend-info">
              <div class="friend-name">${friend.name}</div>
              <div class="friend-status">${status} ‚Ä¢ ${friend.city}</div>
            </div>
            <div class="friend-actions">
              <div class="btn-chat" title="–ù–∞–ø–∏—Å–∞—Ç—å">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#e1bee7" viewBox="0 0 16 16">
                  <path d="M15.964.686a.5.5 0 0 0-.65-.65L.767 5.855H.766l-.452.19a.5.5 0 0 0-.082.887l.41.26.001.002 4.995 3.178 3.178 4.995.002.001.26.41a.5.5 0 0 0 .886-.083l6-15Zm-1.833 1.89L6.637 10.07l-.215-.338a.5.5 0 0 0-.156-.257L5.509 9.02l.932-.562 1.222 1.834a.5.5 0 0 0 .755.157l5.11-6.813-1.897 1.897-.896.896 2.012 1.263-.896.896-1.263-2.012-.375.375.375.375-1.274 1.274Z"/>
                </svg>
              </div>
            </div>
          `;
          
          friendsList.appendChild(friendElement);
        });
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è —á–∞—Ç–∞
    function checkChatStatus() {
      const chatEmpty = document.getElementById('chat-empty');
      const chatContent = document.getElementById('chat-content');
      const babaWelcome = document.getElementById('baba-welcome');
      
      if (!userData.currentChat) {
        chatEmpty.style.display = 'block';
        chatContent.style.display = 'none';
      } else {
        chatEmpty.style.display = 'none';
        chatContent.style.display = 'block';
        
        // –°–∫—Ä—ã–≤–∞–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –±–∞–±—ã –ú–∞—à–∏ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
        setTimeout(() => {
          babaWelcome.style.display = 'none';
        }, 5000);
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤–æ–ø—Ä–æ—Å–∞
    function loadQuestion(index) {
      const question = compatibilityTest.questions[index];
      document.getElementById('question-title').textContent = question.text;
      
      // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –æ—Ç–≤–µ—Ç—ã
      const answersContainer = document.getElementById('answers-container');
      answersContainer.innerHTML = '';
      
      // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –æ—Ç–≤–µ—Ç—ã
      question.answers.forEach((answer, i) => {
        const answerBtn = document.createElement('button');
        answerBtn.className = 'answer-btn';
        answerBtn.textContent = answer;
        answerBtn.onclick = function() { selectAnswer(this, i + 1); };
        answersContainer.appendChild(answerBtn);
      });
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
      const progress = (index / compatibilityTest.questions.length) * 100;
      document.getElementById('test-progress').style.width = `${progress}%`;
      
      // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–î–∞–ª–µ–µ"
      document.getElementById('next-question-btn').style.display = 'none';
    }
    
    // –§—É–Ω–∫—Ü–∏—è –≤—ã–±–æ—Ä–∞ –æ—Ç–≤–µ—Ç–∞
    function selectAnswer(element, answerIndex) {
      // –£–¥–∞–ª—è–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤
      document.querySelectorAll('.answer-btn').forEach(btn => {
        btn.classList.remove('selected');
      });
      
      // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç
      element.classList.add('selected');
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç–≤–µ—Ç
      userData.answers[compatibilityTest.currentQuestion] = answerIndex;
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–î–∞–ª–µ–µ"
      document.getElementById('next-question-btn').style.display = 'block';
    }
    
    // –§—É–Ω–∫—Ü–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
    function nextQuestion() {
      compatibilityTest.currentQuestion++;
      
      if (compatibilityTest.currentQuestion < compatibilityTest.questions.length) {
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å
        loadQuestion(compatibilityTest.currentQuestion);
      } else {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        showResults();
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    function showResults() {
      document.getElementById('test-questions').style.display = 'none';
      document.getElementById('test-results').style.display = 'block';
      
      // –í—ã—á–∏—Å–ª—è–µ–º —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
      const score = 70 + Math.floor(Math.random() * 25);
      document.getElementById('compatibility-score').textContent = `${score}%`;
      
      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ
      let desc = '';
      if (score > 85) {
        desc = `–ë–∞–±–∞ –ú–∞—à–∞ –∑–∞–≥–ª—è–Ω—É–ª–∞ –≤ –∫—Ä–∏—Å—Ç–∞–ª—å–Ω—É—é —Å—Ñ–µ—Ä—É –∏ —É–≤–∏–¥–µ–ª–∞, —á—Ç–æ —É –≤–∞—Å –ø—Ä–æ—Å—Ç–æ –∏–¥–µ–∞–ª—å–Ω–∞—è —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ª—é–¥—å–º–∏ –≤ –Ω–∞—à–µ–º —Å–æ–æ–±—â–µ—Å—Ç–≤–µ! 
        –í—ã –æ–±–ª–∞–¥–∞–µ—Ç–µ —Ä–µ–¥–∫–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é –Ω–∞—Ö–æ–¥–∏—Ç—å –æ–±—â–∏–π —è–∑—ã–∫ —Å —Ä–∞–∑–Ω—ã–º–∏ –ª—é–¥—å–º–∏. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –±—ã—Ç—å —Å–æ–±–æ–π, –∏ —É–¥–∞—á–∞ –±—É–¥–µ—Ç —Å–æ–ø—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤–∞–º!`;
      } else if (score > 70) {
        desc = `–ë–∞–±–∞ –ú–∞—à–∞ –∑–∞–≥–ª—è–Ω—É–ª–∞ –≤ –∫—Ä–∏—Å—Ç–∞–ª—å–Ω—É—é —Å—Ñ–µ—Ä—É –∏ —É–≤–∏–¥–µ–ª–∞, —á—Ç–æ —É –≤–∞—Å –ø—Ä–µ–∫—Ä–∞—Å–Ω–∞—è —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ª—é–¥—å–º–∏ –≤ –Ω–∞—à–µ–º —Å–æ–æ–±—â–µ—Å—Ç–≤–µ! 
        –í—ã —Ü–µ–Ω–∏—Ç–µ –∏—Å–∫—Ä–µ–Ω–Ω–æ—Å—Ç—å –∏ –¥—É—à–µ–≤–Ω—ã–µ —Ä–∞–∑–≥–æ–≤–æ—Ä—ã, —á—Ç–æ —Ä–µ–¥–∫–æ—Å—Ç—å –≤ –Ω–∞—à–µ –≤—Ä–µ–º—è. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –±—ã—Ç—å —Å–æ–±–æ–π!`;
      } else {
        desc = `–ë–∞–±–∞ –ú–∞—à–∞ –∑–∞–≥–ª—è–Ω—É–ª–∞ –≤ –∫—Ä–∏—Å—Ç–∞–ª—å–Ω—É—é —Å—Ñ–µ—Ä—É –∏ —É–≤–∏–¥–µ–ª–∞, —á—Ç–æ —É –≤–∞—Å —Ö–æ—Ä–æ—à–∞—è —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ª—é–¥—å–º–∏ –≤ –Ω–∞—à–µ–º —Å–æ–æ–±—â–µ—Å—Ç–≤–µ! 
        –ò–Ω–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –≤—Ä–µ–º—è, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ —Ç–µ—Ö, —Å –∫–µ–º –≤—ã –±—É–¥–µ—Ç–µ –ø–æ–Ω–∏–º–∞—Ç—å –¥—Ä—É–≥ –¥—Ä—É–≥–∞ —Å –ø–æ–ª—É—Å–ª–æ–≤–∞. –ù–µ –ø–µ—Ä–µ–∂–∏–≤–∞–π—Ç–µ, –≤—Å–µ –≤ —Ä—É–∫–∞—Ö –í—Å–µ–ª–µ–Ω–Ω–æ–π!`;
      }
      
      document.getElementById('compatibility-desc').textContent = desc;
      
      // –ò–º–∏—Ç–∞—Ü–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –æ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–µ
      setTimeout(() => {
        showMatchProposal();
      }, 2000);
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è —á–∞—Ç–∞
    function openChat(chatId) {
      document.getElementById('chat-empty').style.display = 'none';
      document.getElementById('chat-content').style.display = 'block';
      document.getElementById('active-chat').style.display = 'block';
      
      // –ù–∞—Ö–æ–¥–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–µ
      const friend = userData.friends.find(f => f.id === chatId);
      const chatUser = allUsers.find(u => u.id === chatId);
      
      if (friend && chatUser) {
        // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —á–∞—Ç–∞
        const chatTitle = document.getElementById('chat-title');
        chatTitle.innerHTML = `
          ${friend.name}
          <span class="chat-city-tag">${chatUser.city === userData.city ? chatUser.city : chatUser.city.substring(0, 3)}</span>
        `;
      }
      
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π —á–∞—Ç
      userData.currentChat = chatId;
      
      // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ –Ω–∏–∂–Ω–µ–π —á–∞—Å—Ç–∏ —á–∞—Ç–∞
      const chatMessages = document.getElementById('chat-messages');
      chatMessages.scrollTop = chatMessages.scrollHeight;
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏—é —á–∞—Ç–∞
      showSection('chat');
    }
    
    // –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
    function sendMessage() {
      const messageInput = document.getElementById('message-input');
      const message = messageInput.value.trim();
      
      if (message) {
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
        if (message.includes('—Ç–µ–ª.') || message.includes('—Ç–µ–ª–µ—Ñ–æ–Ω') || 
            message.includes('@') || message.includes('http')) {
          alert('–í–Ω–∏–º–∞–Ω–∏–µ! –í —Å–æ–æ–±—â–µ–Ω–∏–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è. –í —Ü–µ–ª—è—Ö –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–µ—â–µ–Ω–æ –æ–±–º–µ–Ω–∏–≤–∞—Ç—å—Å—è –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ –≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.');
          return;
        }
        
        // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
        const messageElement = document.createElement('div');
        messageElement.className = 'message self';
        
        messageElement.innerHTML = `
          <div class="message-content">${message}</div>
          <div class="message-time">${getCurrentTime()}</div>
        `;
        
        // –î–æ–±–∞–≤–ª—è–µ–º –≤ —á–∞—Ç
        document.getElementById('chat-messages').appendChild(messageElement);
        
        // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
        messageInput.value = '';
        
        // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ –Ω–∏–∂–Ω–µ–π —á–∞—Å—Ç–∏ —á–∞—Ç–∞
        const chatMessages = document.getElementById('chat-messages');
        chatMessages.scrollTop = chatMessages.scrollHeight;
        
        // –ò–º–∏—Ç–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞
        if (Math.random() > 0.3) {
          setTimeout(() => {
            const responseElement = document.createElement('div');
            responseElement.className = 'message';
            
            const responses = [
              "–°–æ–≥–ª–∞—Å–µ–Ω(—Å–Ω–∞) —Å —Ç–æ–±–æ–π –ø–æ–ª–Ω–æ—Å—Ç—å—é! –ë–∞–±–∞ –ú–∞—à–∞ —Å–µ–≥–æ–¥–Ω—è —Ç–æ–∂–µ –≥–æ–≤–æ—Ä–∏–ª–∞ –æ–± —ç—Ç–æ–º.",
              "–ö–∞–∫ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ! –†–∞—Å—Å–∫–∞–∂–∏ –±–æ–ª—å—à–µ –æ–± —ç—Ç–æ–º?",
              "–Ø —Ç–æ–∂–µ —Ç–∞–∫ –¥—É–º–∞—é. –í–∏–¥–∏–º–æ, –º—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã!",
              "–≠—Ç–æ –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ! –ê —Ç—ã –≤–µ—Ä–∏—à—å –≤ –∑–Ω–∞–∫–∏ —Å—É–¥—å–±—ã?",
              "–ë–∞–±–∞ –ú–∞—à–∞ –ø–æ–¥—Å–∫–∞–∑–∞–ª–∞ –º–Ω–µ —Å–µ–≥–æ–¥–Ω—è, —á—Ç–æ —è –≤—Å—Ç—Ä–µ—á—É —á–µ–ª–æ–≤–µ–∫–∞ —Å –ø–æ—Ö–æ–∂–∏–º–∏ –≤–∑–≥–ª—è–¥–∞–º–∏. –î—É–º–∞—é, —ç—Ç–æ —Ç—ã!"
            ];
            
            responseElement.innerHTML = `
              <div class="message-content">${responses[Math.floor(Math.random() * responses.length)]}</div>
              <div class="message-time">${getCurrentTime()}</div>
            `;
            
            document.getElementById('chat-messages').appendChild(responseElement);
            chatMessages.scrollTop = chatMessages.scrollHeight;
          }, 1500);
        }
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ç–æ
    function sendPhoto(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
          // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —Å —Ñ–æ—Ç–æ
          const messageElement = document.createElement('div');
          messageElement.className = 'message self';
          
          messageElement.innerHTML = `
            <div class="message-content">
              <img src="${e.target.result}" alt="–§–æ—Ç–æ" class="message-image">
            </div>
            <div class="message-time">${getCurrentTime()}</div>
          `;
          
          // –î–æ–±–∞–≤–ª—è–µ–º –≤ —á–∞—Ç
          document.getElementById('chat-messages').appendChild(messageElement);
          
          // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞
          event.target.value = '';
          
          // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ –Ω–∏–∂–Ω–µ–π —á–∞—Å—Ç–∏ —á–∞—Ç–∞
          const chatMessages = document.getElementById('chat-messages');
          chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        reader.readAsDataURL(file);
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
    function getCurrentTime() {
      const now = new Date();
      return `${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}`;
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –Ω–∞–∑–∞–¥
    function goBack() {
      if (currentSection === 'chat') {
        showSection('friends');
      } else if (currentSection === 'compatibility-test') {
        if (document.getElementById('match-notification').style.display === 'block') {
          document.getElementById('match-notification').style.display = 'none';
          document.getElementById('test-results').style.display = 'block';
        } else if (document.getElementById('test-results').style.display === 'block') {
          document.getElementById('test-results').style.display = 'none';
          document.getElementById('test-questions').style.display = 'block';
          loadQuestion(compatibilityTest.currentQuestion);
        } else {
          showSection('friends');
        }
      } else {
        showSection('friends');
      }
      
      // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ù–∞–∑–∞–¥", –µ—Å–ª–∏ –≤–µ—Ä–Ω—É–ª–∏—Å—å –Ω–∞ –Ω–∞—á–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω
      if (currentSection === 'friends') {
        document.querySelector('.btn-back').style.display = 'none';
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    function initApp() {
      createStars();
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      setTimeout(() => {
        document.querySelector('.btn-back').style.display = 'none';
      }, 500);
    }
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    window.onload = initApp;
  </script>
</body>
</html>